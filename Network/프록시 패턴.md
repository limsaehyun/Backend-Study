# 프록시 패턴



## 프록시 정의

프록시(Proxy)를 직역하면 대리자, 대변인이라는 의미를 가지고 있다. 이는 누군가를 대신해서 그 역할을 수행하는 것을 의미한다. 이는 프로그래밍에서도 똑같이 적용된다. 즉, 프록시에게 어떠한 일을 시키는 것이다.

- 이는 사장님이 사소한 질문을 하기보다는 비서한테 먼저 물어보는 개념과 비슷하다고 할 수 있다.

객체를 사용하고자 할 때, 객체를 직접적으로 참조 하는것이 아니라, 해당 객체를 대행(대리, proxy)하는 객체를 통해 대상객체에 접근하는 방식을 사용하면 해당 객체가 메모리에 존재하지 않아도 기본적인 정보를 참조하거나 설정할 수 있고 또한 실제 객체의 기능이 반드시 필요한 시점까지 객체의 생성을 미룰 수 있다.

![Untitled](https://s3-us-west-2.amazonaws.com/secure.notion-static.com/8c9b5308-6e30-489d-9a63-54cc5c3fb452/Untitled.png)

예를 들어서 큰 이미지와 글이 있는 게시글을 생각해보자. 이미지는 무겁고 글은 가볍기에 글이 먼저 처리되고 그 후에 이미지가 처리되는 걸 확인할 수 있다. 이를 통해 느낄 수 있는건 이미지와 글 모두 로딩 후 처리를 하기보단 글 먼저 로딩하고 이미지를 로딩하는 방식이 낮다. 따라서 이미지 처리용 프로세서, 글 처리용 프로세서를 별도로 운영하는 것이 좋다. 이러한 구조를 프론시 패턴이라고 한다. 일반적으로 프록시는 다른 무언가와 이어지는 인터페이스의 역햘을 하는 클래스를 의미한다.



## 프록시가 사용되는 대표적인 3가지



### 가상프록시

꼭 필요로 하는 시점까지 **객체의 생성을 연기**하고, 해당 객체가 생성된 것처럼 동작하도록 만들고 싶을때 사용하는 패턴이다.

프록시 클래스가 자잘한 작업들을 처리하고 리소스가 많이 요구되는 작업들이 필요할 때에만 주체 클래스를 사용하도록 구현한다.

- 예시

  해상도가 아주 높은 이미지를 처리해야 하는 경우 작업을 분산하는것을 예로 들 수 있다.

  

### 원격프록시

원격 객체에 대한 **접근이 제어 로컬 환경에 존재**하며, 원벽객체에 대한 **대변자 역할을 하는 객체**이다. 서로다른 주소 공간에 있는 객체에 대해 마치 같은 주소 공간에 있는 것처럼 동작하게 만드는 패턴이다.

- 예시

  Google Docs. 브라우저는 브라우저대로 필요한 자원을 로컬에 가지고 있고 도다른 자원은 Google 서버에 있는 형태이다.

  

### 보호프록시

주체 클래스에 대한 접근을 제어하기 위한 경우에 객체에 대한 접근 권한을 제어하거나 객체마다 접근 권한을 달리하고 싶을때 사용하는 패턴이다.

프록시 클래스에서 클라이언트가 주체 클래스에 대한 접근을 허용하지 말지 결정하도록 하는 함수가 있다.



## 프록시 패턴의 장단점



### 장점

- 사이드가 큰 객체가 로딩되기 전에도 프록시를 통해 참조를 할 수 있다.

- 실제 객체의 public, protected 메소드들을 숨기고 인터페이스를 통해 노출시킬 수 있다.

- 로컬에 있지 않고 떨어져 있는 객체를 사용할 수 있다.

- 원래 객체의 접근에 대해서 사전처리를 할 수 있다.

  

### 단점

- 객체를 생성할때 한단계를 거치게 되므로, 빈번한 객체 생성이 필요한 경우 성능이 저하될 수 있다.
- 프록시 내부에서 객체 생성을 위해 스레드가 생성, 동기화가 구현되야 하는 경우 성능이 저하될 수 있다.
- 로직이 난해해져 가독성이 떨어질 수 있다.